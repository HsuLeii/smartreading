<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRE-eBook</title>

    <!-- this page widgets CSS -->
    <!-- modal -->
    <link rel="stylesheet" href="css/jquery.modal.min.css" />


    <link rel="shortcut icon" type="image/x-icon" href="image/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="css/SREebook.css">
</head>


<body>
    <header>
        <div class="book-logo">
            <img src="image/logo.png" alt="">
        </div>
        <button class="close cursor background-icon">
        </button>
    </header>

    <div class="book-page-one">
        <form name="form1" method="post" action="./gptvb3.aspx" id="form1">
            <div>
                <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE"
                    value="/wEPDwULLTExODQxODc1NTgPFgIeE1ZhbGlkYXRlUmVxdWVzdE1vZGUCARYCAgMPZBYKAgsPFgIeCWlubmVyaHRtbAULWWVzIEkgaGF2ZS5kAg0PFgIfAQUMWWVzLCBJIGhhdmUuZAIPDw8WAh4EVGV4dAUVPGg0PuaWh+azleagoemWsTwvaDQ+ZGQCEQ8PFgIfAgUe4piF4piF4piF4piF4piG4piG4piG4piG4piG4piGZGQCEw8PFgIfAgXZAjxici8+5bu66K2w562U5qGI77yaWWVzLCBJIGxvc3QgbXkgd2FsbGV0LiBJIGZvdW5kIGl0IGEgd2VlayBsYXRlci4gPGJyPiA8YnI+5pu05aSa6KmV6Kqe77yaPGJyPuS9oOeahOetlOahiOmDqOWIhuespuWQiOmhjOebruimgeaxgu+8jOS9huWPquWbnuetlOS6huesrOS4gOWAi+WVj+mhjO+8jOe8uuWwkeS6huWwjeaWvOWkseWOu+eahOeJqeWTgeeahOaPj+i/sOS7peWPiuaYr+WQpuaJvuWbnueahOWbnuetlOOAguiqnuazleS4iuaykuaciemMr+iqpO+8jOS9huWFp+WuueS4jeWujOaVtOOAguW7uuitsOWcqOWbnuetlOS4reWMheWQq+WFt+mrlOeahOeJqeWTgeWQjeeoseWSjOebuOmXnOaDheazgeOAgmRkZCFiluwNGVImeqxbg0c6E286QZYjts9DiB031YscIYkI">
            </div>
    
            <div>
                <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="116EE86D">
                <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION"
                    value="/wEdAAZyc2qgPgopKJoxM7ONZy8wP5i3afZssjrMX07jH+s1p4z2RJFHbaa92BJAwZOe+oAFW5tgmEZtFGK+jwLyP4GcHAyvFHuFZdddlhoiLiwUIM34O/GfAV4V4n0wgFZHr3fhWPHq4d8HkXS+rqzBLjW6IMxTxH7IEo2pQIsIFzogiQ==">
            </div>

            <div class="course_area">
                    <div class="course_name">
                        <h4>
                            What Color Is It?
                        </h4>
                    </div>
                    <div class="course_img_area">
                        <div class="course_img">
                            <img src="image/picturebook/cover_NU0041.jpg" alt="">
                        </div>
                    </div>
            </div>

<div class="answer_area">
    <div class="topic_area">
        <div class="topic_img_area">
            <div class="topic_img">
                <img src="image/picturebook/NU0041P1.jpg" alt="">
            </div>
        </div>
    </div>

    <div class="usermessage_area">
        <div class="topic_name">
            <h4>
                What color is it?
            </h4>
        </div>
        <div class="usermessage">
            <textarea class="usermessage_textarea" name="TB_usermessage" id="TB_usermessage" placeholder="輸入你的回答" rows="6" cols="120"></textarea>
      
            <button class="usermessage_btn">送出</button>
          </div>
    </div>

    <div class="feedback_area">
        <div class="user_answer">
            <p>
                你的回答：red
            </p>
        </div>
    </div>
</div>
            
            <textarea rows="6" cols="120" >Yes I have.</textarea>


            <div>
    
                <h2>SRE 寫作批改測試-- 主題設定：
                    有評分<select id="DD_sys" size="4" style="width:120px;">
                        <option value="L3-1">L3-1 句型練習</option>
                        <option value="L5-1">L5-1 句型練習</option>
                        <option value="L7-1">L7-1 自由書寫</option>
                        <option value="L9-1">L9-1 自由書寫</option>
    
                    </select>
                    <select id="DD_sys2" size="4" style="width:120px;display:none">
                        <option value="L3-2">L3-2 句型練習</option>
                        <option value="L5-2">L5-2 句型練習</option>
                        <option value="L7-2">L7-2 自由書寫</option>
                        <option value="L9-2">L9-2 自由書寫</option>
    
                    </select>
                </h2>

                <textarea name="TB_syswork" rows="16" cols="120" id="TB_syswork">你是一位英文老師，負責批改學生的英文答案。請根據題目的要求，判斷學生的答案是否正確，並根據以下標準給予 0 至 10 分的評分。你的回應應遵循以下格式：
                回應格式
                建議答案：（提供與學生答案最相似的正確答案）。
                [評分：X]（X 為 0-10 分）。
                更多評語：
                是否符合題目的要求（若答案不符合題目，請明確指出問題，但請勿直接引用題目背景資訊）。
                語法與用詞錯誤（如：動詞時態、助動詞使用、單複數、冠詞、句子結構、句首大寫、句尾標點等）。
                
                評分標準
                10 分：答案完全正確，語法、拼寫、標點符號無誤。
                8-9 分：答案基本正確，但有輕微錯誤（如標點、拼寫或細微語法錯誤）。
                6-7 分：答案部分正確，但有語法錯誤或句子結構問題。
                3-5 分：答案有嚴重語法錯誤或拼寫錯誤，但仍部分符合題目要求。
                1-2 分：答案幾乎不符合題目要求，但仍包含部分可辨識的正確單字。
                0 分：答案完全錯誤，或與題目要求無關。  </textarea>

                <br>
                <img src="111.png" width="600" border="1" id="mphoto"><span id="mshow">顯示原圖片</span>
                <br>
                題目：
                <br>
                <textarea name="TB_maincontent" rows="3" cols="120"
                    id="TB_maincontent">Have you lost anything? What is it? Did you get it back? 用10~60個英文字來回答 </textarea>
                <br>
                背景： <br>
                <textarea name="TB_maincontent2" rows="3" cols="120" id="TB_maincontent2"></textarea>
                <br>
    
                <hr>
                學生作答：
                <br>
                <textarea name="TB_usermessage" rows="6" cols="120" id="TB_usermessage">Yes I have.</textarea>
                <br>
    
                <br>
    
                <input type="submit" name="Button1" value="送出提問" id="Button1" style="height:60px;width:240px;">
    
    
                <hr>
    
    
    
                <div id="itemanswer" style="display:none">Yes I have.</div>
                <div id="itemanswer2" style="display:none">Yes, I have.</div>
    
                <span id="LB_difftitle" style="font-size:Larger;">
                    <h4>文法校閱</h4>
                </span>
    
                <div id="diffResult">Yes<ins2>,</ins2> I have.</div>
    
    
                <hr>
                <h3>內容評析</h3>
                <span id="Label2" style="font-size:Larger;">★★★★☆☆☆☆☆☆</span><br>
                <span id="Label1"><br>建議答案：Yes, I lost my wallet. I found it a week later. <br>
                    <br>更多評語：<br>你的答案部分符合題目要求，但只回答了第一個問題，缺少了對於失去的物品的描述以及是否找回的回答。語法上沒有錯誤，但內容不完整。建議在回答中包含具體的物品名稱和相關情況。</span>
    
    
    
            </div>
        </form>
    </div>
    


    <script>
        // 获取下拉选单和文本框的元素
        var dropdown = document.getElementById("DD_sys");
        var tbsys = document.getElementById("TB_syswork");
        var tbsys1 = document.getElementById("TB_maincontent");
        var tbsys2 = document.getElementById("TB_maincontent2");
        var tbuser = document.getElementById("TB_usermessage");
        var tbtoken = 800 // document.getElementById("TB_token");

        var dropdown2 = document.getElementById("DD_sys2");


        // 添加change事件监听器
        dropdown.addEventListener("change", function () {
            // 根据选中的值更新文本框内容
            tbsys.textContent = `你是一位英文老師，負責批改學生的英文答案。請根據題目的要求，判斷學生的答案是否正確，並根據以下標準給予 0 至 10 分的評分。你的回應應遵循以下格式：
回應格式
建議答案：（提供與學生答案最相似的正確答案）。
[評分：X]（X 為 0-10 分）。
更多評語：
是否符合題目的要求（若答案不符合題目，請明確指出問題，但請勿直接引用題目背景資訊）。
語法與用詞錯誤（如：動詞時態、助動詞使用、單複數、冠詞、句子結構、句首大寫、句尾標點等）。

評分標準
10 分：答案完全正確，語法、拼寫、標點符號無誤。
8-9 分：答案基本正確，但有輕微錯誤（如標點、拼寫或細微語法錯誤）。
6-7 分：答案部分正確，但有語法錯誤或句子結構問題。
3-5 分：答案有嚴重語法錯誤或拼寫錯誤，但仍部分符合題目要求。
1-2 分：答案幾乎不符合題目要求，但仍包含部分可辨識的正確單字。
0 分：答案完全錯誤，或與題目要求無關。  `;
            var selectedValue = dropdown.value;
            switch (selectedValue) {
                case "L3-1":
                    // 你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。\n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。;
                    tbsys1.textContent = "(Apple)What color is it?"
                    tbsys2.textContent =
                        "There are (fruits, teacher, students, blackboard) in the scene and the correct answer required is either 'It is red.' or 'It's red.'"

                    tbuser.textContent = "it is red";


                    break;
                case "L5-1":
                    // tbsys.textContent = "你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。 \n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。";

                    tbsys1.textContent = "What does the girl has?"
                    tbsys2.textContent =
                        "The correct answer required either 'She has a bus.' or 'She has a red bus.' or 'She has a toy bus.'"

                    tbuser.textContent = "A red car";


                    break;
                case "L7-1":
                    //  tbsys.textContent = "你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求(最好以10~60個英文字完成作答)，並用中文回應。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。 \n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。";
                    tbsys1.textContent =
                        "Have you lost anything? What is it? Did you get it back? 用10~60個英文字來回答 "
                    tbsys2.textContent = ""
                    tbuser.textContent = "Yes I have lost money.";
                    break;
                case "L9-1":
                    //    tbsys.textContent = "你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求(最好以10~60個英文字完成作答)，並用中文回應。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。 \n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。";
                    tbsys1.textContent = "Do you think teamwork is important? Why? 用10~60個英文字來回答 "
                    tbsys2.textContent = ""
                    tbuser.textContent = "I can do it alone. teamwork is important? what aru you say";
                    break;

                default:
                    tbsys.textContent = "";
                    break;
            }
        });




        dropdown2.addEventListener("change", function () {
            // 根据选中的值更新文本框内容
            var selectedValue = dropdown2.value;
            tbsys.textContent = `你是一位英文老師，負責批改學生的英文答案。請根據題目的要求，判斷學生的答案是否正確。你的回應應遵循以下格式：
評語內容
你的回應應包括以下幾點：
1.是否符合題目的要求：若答案不符合題目要求，請明確指出問題，但請勿直接引用題目背景資訊。
2.語法與用詞的錯誤（如：動詞時態、助動詞使用、單複數、冠詞、句子結構、句首大寫、句尾標點等）。
3.改善建議（提供具體的修正方式，讓學生能夠理解如何改進，但請勿提及題目背景資訊）。  `;


            switch (selectedValue) {
                case "L3-2":
                    // 你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。\n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。;
                    tbsys1.textContent = "(Apple)What color is it?"
                    tbsys2.textContent =
                        "There are (fruits, teacher, students, blackboard) in the scene and the correct answer required is either 'It is red.' or 'It's red.'"

                    tbuser.textContent = "it is red";


                    break;
                case "L5-2":
                    // tbsys.textContent = "你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。 \n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。";

                    tbsys1.textContent = "What does the girl has?"
                    tbsys2.textContent =
                        "There are (2 boys, 2 girls, 4 toys, green car, red bus, yellow motorbike, blue truck) in the scene and the correct answer required either 'She has a bus.' or 'She has a red bus.' or 'She has a toy bus.'"

                    tbuser.textContent = "A red car";


                    break;
                case "L7-2":
                    //  tbsys.textContent = "你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求(最好以10~60個英文字完成作答)，並用中文回應。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。 \n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。";
                    tbsys1.textContent =
                        "Have you lost anything? What is it? Did you get it back? 用10~60個英文字來回答 "
                    tbsys2.textContent = ""
                    tbuser.textContent = "Yes I have lost money.";
                    break;
                case "L9-2":
                    //    tbsys.textContent = "你是一位英文老師，負責批改學生的英文答案。請根據題目背景，判斷學生的答案是否符合題目的要求(最好以10~60個英文字完成作答)，並用中文回應。你的回應應包括：\n1.是否符合題目的要求（若文不對題，請明確指出並解釋原因，但請勿直接引用題目背景資訊）。\n2.語法與用詞的錯誤（包含：動詞時態、助動詞使用、單複數、冠詞、句子的結構、句首是否正確大寫，句尾是否有適當的標點符號等）。 \n3.改善建議（讓學生更清楚如何修正答案，但請勿提及題目背景資訊）。\n4.回應內容以中文為主，但仍可適當提供英文示範句，以幫助學生理解。";
                    tbsys1.textContent = "Do you think teamwork is important? Why? 用10~60個英文字來回答 "
                    tbsys2.textContent = ""
                    tbuser.textContent = "I can do it alone. teamwork is important? what aru you say";
                    break;

                default:
                    tbsys.textContent = "";
                    break;
            }
        });
    </script>
    <script>
        $(document).ready(function () {
            var text1 = $('#itemanswer').html();
            var text2 = $('#itemanswer2').html();

            var diffHtml = compareTexts(text1, text2);



            $('#diffResult').html(diffHtml);

            $("#mshow").click(function () {
                $("#mphoto").toggle(); // 切換顯示或隱藏
                let isVisible = $("#mphoto").is(":visible"); // 判斷當前狀態
                $("#mshow").text(isVisible ? "隱藏原圖片" : "顯示原圖片"); // 變更按鈕文字
            });

            $('del2').hover(function () {
                var insTag = $(this).next('ins2');
                if (insTag.length > 0 && insTag.text().trim() !== '') {
                    //  console.log("有內容");
                    if ($('.tooltipx').length == 0) {
                        $('body').append('<div class="tooltipx"></div>');
                        //   console.log("建立tooltipx");
                    }

                    $('.tooltipx').text(insTag.text());
                    //  console.log("填入", insTag.text());
                    var offset = $(this).offset();
                    $('.tooltipx').css({
                        'top': (offset.top - $(this).outerHeight() - 10) +
                        'px', // 10px above the del tag
                        'left': offset.left + 'px'
                    });
                    $('.tooltipx').show();
                }
            }, function () {
                // Hide the tooltip when not hovering
                $('.tooltipx').hide();
            });

        });

        function compareTexts(text1, text2) {
            var dmp = new diff_match_patch();
            var diffs = dmp.diff_main(text1, text2);
            dmp.diff_cleanupSemantic(diffs);



            var diffHtml = '';
            for (var i = 0; i < diffs.length; i++) {
                var diff = diffs[i];
                var value = diff[1];
                var type = diff[0];

                if (type === 0) {
                    diffHtml += value;
                } else if (type === -1) {
                    diffHtml += '<del2>' + value + '</del2>';
                } else if (type === 1) {
                    diffHtml += '<ins2>' + value + '</ins2>';
                }
                // console.log(type, value);
            }

            return diffHtml;
        }
    </script>
</body>

<div class="book-page-one">
    <div class="course_area">
        <div class="course_name">
            <h4>
                新同學
            </h4>
        </div>
        <div class="course_img_area">
            <div class="course_img">
                <img src="image/picturebook/1.png" alt="">
            </div>
        </div>
    </div>

    <div class="dialogue_area">
        <div class="dialogue_block_area">
            <div class="chat-history_content">
                <div class="dialogue_block dialogue_left">
                    <div class="dialogue_avatar">
                        <div class="avatar_text">
                            <h4>B</h4>
                        </div>
                    </div>

                    <div class="dialog_box">
                        <div class="dialog_box_text">
                            <p>
                                B留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言留言
                            </p>
                        </div>
                    </div>

                    <div class="dialog_time">
                        <p>
                            2025/03/19 10:10
                        </p>
                    </div>
                </div>

                <div class="dialogue_block dialogue_right">
                    <div class="dialogue_avatar">
                        <div class="avatar_text">
                            <h4>A</h4>
                        </div>
                    </div>

                    <div class="dialog_box">
                        <div class="dialog_box_text">
                            <p>
                                A留言留言留言留言留言留言
                            </p>
                        </div>
                    </div>

                    <div class="dialog_time">
                        <p>
                            2025/03/19 10:10
                        </p>
                    </div>
                </div>

                <div class="dialogue_block dialogue_left">
                    <div class="dialogue_avatar">
                        <div class="avatar_text">
                            <h4>C</h4>
                        </div>
                    </div>

                    <div class="dialog_box">
                        <div class="dialog_box_text">
                            <p>
                                C留言留言留言留言留言留言
                            </p>
                        </div>
                    </div>

                    <div class="dialog_time">
                        <p>
                            2025/03/19 10:10
                        </p>
                    </div>
                </div>

                <div class="dialogue_block dialogue_right">
                    <div class="dialogue_avatar">
                        <div class="avatar_text">
                            <h4>A</h4>
                        </div>
                    </div>

                    <div class="dialog_box">
                        <div class="dialog_box_text">
                            <p>A留言</p>
                        </div>
                    </div>

                    <div class="dialog_time">
                        <p>
                            2025/03/19 10:10
                        </p>
                    </div>
                </div>

                <div class="dialogue_block dialogue_left">
                    <div class="dialogue_avatar">
                        <div class="avatar_text">
                            <h4>D</h4>
                        </div>
                    </div>

                    <div class="dialog_box">
                        <div class="dialog_box_text">
                            <p>
                                D留言
                            </p>
                        </div>
                    </div>

                    <div class="dialog_time">
                        <p>
                            2025/03/19 10:10
                        </p>
                    </div>
                </div>
            </div>


        </div>

        <div class="dialogue_message">
            <textarea class="dialogue_textarea" id="message_to_send" placeholder="輸入你的留言" rows="5"></textarea>

            <button class="dialogue_btn">送出</button>
        </div>
    </div>


</div>



<script src="js/jquery-3.5.1.min.js"></script>

<!-- this page widgets JS -->
<!-- modal -->
<script src="js/jquery.modal.min.js"></script>

<!-- fontawesome -->
<script src="js/fontawesome-free-6.1.1.min.js"></script>

</body>

</html>